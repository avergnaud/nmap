<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<title>Markmap</title>
<style>
* {
  margin: 0;
  padding: 0;
}
#mindmap {
  display: block;
  width: 100vw;
  height: 100vh;
}
</style>
<link rel="stylesheet" href="https://unpkg.com/markmap-toolbar@0.18.9/dist/style.css"><link rel="stylesheet" href="https://unpkg.com/@highlightjs/cdn-assets@11.11.1/styles/default.min.css">
</head>
<body>
<svg id="mindmap"></svg>
<script src="https://unpkg.com/d3@7.9.0/dist/d3.min.js"></script><script src="https://unpkg.com/markmap-view@0.18.9/dist/browser/index.js"></script><script src="https://unpkg.com/markmap-toolbar@0.18.9/dist/index.js"></script><script>((r) => {
          setTimeout(r);
        })(() => {
  const { markmap, mm } = window;
  const toolbar = new markmap.Toolbar();
  toolbar.attach(mm);
  const el = toolbar.render();
  el.setAttribute("style", "position:absolute;bottom:20px;right:20px");
  document.body.append(el);
})</script><script>((getMarkmap, getOptions, root2, jsonOptions) => {
              const markmap = getMarkmap();
              window.mm = markmap.Markmap.create(
                "svg#mindmap",
                (getOptions || markmap.deriveOptions)(jsonOptions),
                root2
              );
            })(() => window.markmap,null,{"content":"nmap host-discovery mindmap","children":[{"content":"(unprivileged) nmap -sn","children":[{"content":"local network","children":[{"content":"use raw ethernet","children":[{"content":"single IP","children":[{"content":"<code>--send-eth</code>option IGNORED","children":[],"payload":{"tag":"li","lines":"14,16"}}],"payload":{"tag":"h4","lines":"12,13"}},{"content":"IP range","children":[{"content":"TODO","children":[],"payload":{"tag":"li","lines":"18,20"}}],"payload":{"tag":"h4","lines":"16,17"}}],"payload":{"tag":"h3","lines":"10,11"}},{"content":"use raw IP (default)","children":[{"content":"single IP","children":[{"content":"default","children":[{"content":"\n<pre data-lines=\"26,29\"><code data-lines=\"26,29\"><span class=\"hljs-attribute\">nmap</span> -sn <span class=\"hljs-number\">172.31.33.32</span>\n</code></pre>\n<p data-lines=\"29,31\"><img src=\"./docs/nmap_unpriv_sn_local.png?raw=true\" alt=\"nmap_unpriv_sn_local\"><br>\n\"Unprivileged nmap -sn always make a TCP handshake (connect call) to ports 80 and 443\"</p>","children":[],"payload":{"tag":"li","lines":"25,32"}},{"content":"\n<pre data-lines=\"33,36\"><code data-lines=\"33,36\"><span class=\"hljs-symbol\">nmap</span> -<span class=\"hljs-meta\">sn</span> --send-<span class=\"hljs-built_in\">ip</span> <span class=\"hljs-number\">192</span>.<span class=\"hljs-number\">168</span>.<span class=\"hljs-number\">79</span>.<span class=\"hljs-number\">201</span>\n</code></pre>\n<p data-lines=\"36,38\"><img src=\"./docs/nmap_unpriv_sn.png?raw=true\" alt=\"nmap_unpriv_sn\"><br>\n\"Unprivileged nmap -sn always make a TCP handshake (connect call) to ports 80 and 443\"</p>","children":[],"payload":{"tag":"li","lines":"32,39"}}],"payload":{"tag":"h5","lines":"24,25"}},{"content":"<code>-PE</code> \"ICMP echo\"","children":[{"content":"\n<pre data-lines=\"41,44\"><code data-lines=\"41,44\"><span class=\"hljs-attribute\">nmap</span> -sn -PE <span class=\"hljs-number\">192.168.79.201</span>\n</code></pre>\n<p data-lines=\"44,46\"><img src=\"./docs/nmap_unpriv_sn_PE.png?raw=true\" alt=\"nmap_unpriv_sn_PE\"><br>\nUnprivileged nmap -sn -PE always (try to) make a TCP handshake (connect call) to port 80.</p>","children":[],"payload":{"tag":"li","lines":"40,47"}},{"content":"\n<pre data-lines=\"48,51\"><code data-lines=\"48,51\"><span class=\"hljs-attribute\">nmap</span> -sn -PE <span class=\"hljs-number\">172.31.33.76</span>\n</code></pre>\n<p data-lines=\"51,53\"><img src=\"./docs/nmap_unpriv_sn_PE_2.png?raw=true\" alt=\"nmap_unpriv_sn_PE_2\"><br>\nUnprivileged nmap -sn -PE always (try to) make a TCP handshake (connect call)  to port 80.</p>","children":[],"payload":{"tag":"li","lines":"47,54"}}],"payload":{"tag":"h5","lines":"39,40"}},{"content":"<code>-PP</code> \"ICMP Timestamp\"","children":[{"content":"TODO","children":[],"payload":{"tag":"li","lines":"56,58"}}],"payload":{"tag":"h5","lines":"54,55"}},{"content":"<code>-PM</code> \"ICMP address mask\"","children":[{"content":"TODO","children":[],"payload":{"tag":"li","lines":"60,62"}}],"payload":{"tag":"h5","lines":"58,59"}},{"content":"<code>-PS</code> \"TCP SYN Ping\"","children":[{"content":"\n<pre data-lines=\"64,68\"><code data-lines=\"64,68\"><span class=\"hljs-keyword\">nmap</span> -<span class=\"hljs-keyword\">sn</span> --send-ip -PS <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">79.201</span>\n<span class=\"hljs-keyword\">nmap</span> -<span class=\"hljs-keyword\">sn</span> -PS <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">79.201</span>\n</code></pre>\n<p data-lines=\"68,70\"><img src=\"./docs/nmap_unpriv_sn_PS.png?raw=true\" alt=\"nmap_unpriv_sn_PS\"><br>\nUnprivileged nmap -sn always make a TCP handshake (connect call).</p>","children":[],"payload":{"tag":"li","lines":"63,71"}},{"content":"\n<pre data-lines=\"72,75\"><code data-lines=\"72,75\"><span class=\"hljs-attribute\">nmap</span> -sn -PS443 <span class=\"hljs-number\">192.168.79.201</span>\n</code></pre>\n<p data-lines=\"75,77\"><img src=\"./docs/nmap_unpriv_sn_PS443.png?raw=true\" alt=\"nmap_unpriv_sn_PS443\"><br>\nUnprivileged nmap -sn always make a TCP handshake (connect call).</p>","children":[],"payload":{"tag":"li","lines":"71,78"}}],"payload":{"tag":"h5","lines":"62,63"}},{"content":"<code>-PA</code> \"TCP ACK Ping\"","children":[{"content":"\n<pre data-lines=\"81,85\"><code data-lines=\"81,85\"><span class=\"hljs-keyword\">nmap</span> -<span class=\"hljs-keyword\">sn</span> -PA <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">79.201</span>\n<span class=\"hljs-keyword\">nmap</span> -<span class=\"hljs-keyword\">sn</span> -PA --send-ip <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">79.201</span>\n</code></pre>\n<img src=\"./docs/nmap_unpriv_sn_PA.png?raw=true\" alt=\"nmap_unpriv_sn_PA\"><br>\nUnprivileged nmap -sn always make a TCP handshake (connect call).","children":[],"payload":{"tag":"li","lines":"80,88"}}],"payload":{"tag":"h5","lines":"78,79"}},{"content":"<code>-PU</code> \"UDP Ping\"","children":[{"content":"\n<pre data-lines=\"91,94\"><code data-lines=\"91,94\"><span class=\"hljs-attribute\">nmap</span> -sn -PU137,<span class=\"hljs-number\">138</span> <span class=\"hljs-number\">192.168.1.23</span>\n</code></pre>\n\"Sorry, UDP Ping (-PU) only works if you are root (because we need to read raw responses off the wire) QUITTING!\"","children":[],"payload":{"tag":"li","lines":"90,96"}}],"payload":{"tag":"h5","lines":"88,89"}}],"payload":{"tag":"h4","lines":"22,23"}},{"content":"IP range","children":[{"content":"default","children":[{"content":"TODO","children":[],"payload":{"tag":"li","lines":"100,102"}}],"payload":{"tag":"h5","lines":"98,99"}},{"content":"<code>-PE</code> \"ICMP echo\"","children":[{"content":"TODO","children":[],"payload":{"tag":"li","lines":"104,106"}}],"payload":{"tag":"h5","lines":"102,103"}},{"content":"<code>-PP</code> \"ICMP Timestamp\"","children":[{"content":"TODO","children":[],"payload":{"tag":"li","lines":"108,110"}}],"payload":{"tag":"h5","lines":"106,107"}},{"content":"<code>-PM</code> \"ICMP address mask\"","children":[{"content":"TODO","children":[],"payload":{"tag":"li","lines":"112,114"}}],"payload":{"tag":"h5","lines":"110,111"}},{"content":"<code>-PS</code> \"TCP SYN Ping\"","children":[{"content":"\n<pre data-lines=\"116,119\"><code data-lines=\"116,119\"><span class=\"hljs-attribute\">nmap</span> -sn -PS1-<span class=\"hljs-number\">1000</span> <span class=\"hljs-number\">192.168.79.201</span>\n</code></pre>\n<img src=\"./docs/nmap_unpriv_sn_PS1-1000.png?raw=true\" alt=\"nmap_unpriv_sn_P1-1000\"><br>\nOn voit que nmap s'arrête après 10 retours RST ACK","children":[],"payload":{"tag":"li","lines":"115,123"}}],"payload":{"tag":"h5","lines":"114,115"}}],"payload":{"tag":"h4","lines":"96,97"}}],"payload":{"tag":"h3","lines":"20,21"}}],"payload":{"tag":"h2","lines":"8,9"}},{"content":"external network","children":[{"content":"use raw ethernet","children":[{"content":"single IP","children":[{"content":"TODO","children":[],"payload":{"tag":"li","lines":"129,131"}}],"payload":{"tag":"h4","lines":"127,128"}},{"content":"IP range","children":[{"content":"TODO","children":[],"payload":{"tag":"li","lines":"133,135"}}],"payload":{"tag":"h4","lines":"131,132"}}],"payload":{"tag":"h3","lines":"125,126"}},{"content":"use raw IP","children":[{"content":"single IP","children":[{"content":"TODO \"only SYN packets are sent (using a connect call) to ports 80 and 443\"","children":[],"payload":{"tag":"li","lines":"139,141"}}],"payload":{"tag":"h4","lines":"137,138"}},{"content":"IP range","children":[{"content":"TODO","children":[],"payload":{"tag":"li","lines":"143,145"}}],"payload":{"tag":"h4","lines":"141,142"}}],"payload":{"tag":"h3","lines":"135,136"}}],"payload":{"tag":"h2","lines":"123,124"}}],"payload":{"tag":"h1","lines":"6,7"}},{"content":"sudo nmap -sn","children":[{"content":"local network","children":[{"content":"use raw ethernet (default)","children":[{"content":"single IP","children":[{"content":"default","children":[{"content":"TODO \"ARP requests are used\"","children":[],"payload":{"tag":"li","lines":"155,157"}}],"payload":{"tag":"h5","lines":"153,154"}},{"content":"<code>-PE</code> \"ICMP echo\"","children":[{"content":"\n<pre data-lines=\"160,163\"><code data-lines=\"160,163\"><span class=\"hljs-attribute\">sudo</span> nmap -sn -PE <span class=\"hljs-number\">192.168.79.201</span>\n</code></pre>\n<p data-lines=\"163,165\"><img src=\"./docs/nmap_priv_sn_PE.png?raw=true\" alt=\"nmap_priv_sn_PE\"><br>\nOn a local ethernet network, ARP requests are used unless --send-ip was specified</p>","children":[],"payload":{"tag":"li","lines":"159,166"}},{"content":"\n<pre data-lines=\"167,170\"><code data-lines=\"167,170\"><span class=\"hljs-attribute\">sudo</span> nmap -sn -PE <span class=\"hljs-number\">172.31.33.76</span>\n</code></pre>\n<p data-lines=\"170,172\"><img src=\"./docs/nmap_priv_sn_PE_2.png?raw=true\" alt=\"priv_sn_PE_2\"><br>\nOn a local ethernet network, ARP requests are used unless --send-ip was specified</p>","children":[],"payload":{"tag":"li","lines":"166,173"}}],"payload":{"tag":"h5","lines":"157,158"}},{"content":"<code>-PP</code> \"ICMP Timestamp\"","children":[{"content":"TODO","children":[],"payload":{"tag":"li","lines":"175,177"}}],"payload":{"tag":"h5","lines":"173,174"}},{"content":"<code>-PM</code> \"ICMP address mask\"","children":[{"content":"TODO","children":[],"payload":{"tag":"li","lines":"179,181"}}],"payload":{"tag":"h5","lines":"177,178"}},{"content":"<code>-PS</code> \"TCP SYN Ping\"","children":[{"content":"\n<pre data-lines=\"184,187\"><code data-lines=\"184,187\"><span class=\"hljs-attribute\">sudo</span> nmap -sn -PS <span class=\"hljs-number\">192.168.79.201</span>\n</code></pre>\n<p data-lines=\"187,189\"><img src=\"./docs/nmap_priv_sn_PS.png?raw=true\" alt=\"nmap_priv_sn_PS\"><br>\nOn a local ethernet network, ARP requests are used unless --send-ip was specified</p>","children":[],"payload":{"tag":"li","lines":"183,190"}},{"content":"\n<pre data-lines=\"191,194\"><code data-lines=\"191,194\"><span class=\"hljs-attribute\">sudo</span> nmap -sn -PS21,<span class=\"hljs-number\">22</span>,<span class=\"hljs-number\">25</span>,<span class=\"hljs-number\">80</span>,<span class=\"hljs-number\">443</span>,<span class=\"hljs-number\">445</span>,<span class=\"hljs-number\">3389</span>,<span class=\"hljs-number\">8080</span> -T4 <span class=\"hljs-number\">192.168.79.201</span>\n</code></pre>","children":[],"payload":{"tag":"li","lines":"190,195"}}],"payload":{"tag":"h5","lines":"181,182"}},{"content":"<code>-PA</code> \"TCP ACK Ping\"","children":[{"content":"\n<pre data-lines=\"198,201\"><code data-lines=\"198,201\"><span class=\"hljs-attribute\">sudo</span> nmap -sn -PA <span class=\"hljs-number\">192.168.79.201</span>\n</code></pre>\n<img src=\"./docs/nmap_priv_sn_PA.png?raw=true\" alt=\"nmap_priv_sn_PA\"><br>\nOn a local ethernet network, ARP requests are used unless --send-ip was specified","children":[],"payload":{"tag":"li","lines":"197,205"}}],"payload":{"tag":"h5","lines":"195,196"}},{"content":"<code>-PU</code> \"UDP Ping\"","children":[{"content":"\n<pre data-lines=\"208,211\"><code data-lines=\"208,211\"><span class=\"hljs-attribute\">sudo</span> nmap -sn -PU137,<span class=\"hljs-number\">138</span> <span class=\"hljs-number\">192.168.1.23</span>\n</code></pre>\n<img src=\"./docs/nmap_priv_sn_PU.png?raw=true\" alt=\"nmap_priv_sn_PU\"><br>\nOn a local ethernet network, ARP requests are used unless --send-ip was specified","children":[],"payload":{"tag":"li","lines":"207,215"}}],"payload":{"tag":"h5","lines":"205,206"}}],"payload":{"tag":"h4","lines":"151,152"}},{"content":"IP range","children":[{"content":"TODO","children":[],"payload":{"tag":"li","lines":"217,219"}}],"payload":{"tag":"h4","lines":"215,216"}}],"payload":{"tag":"h3","lines":"149,150"}},{"content":"use raw IP","children":[{"content":"single IP","children":[{"content":"default","children":[{"content":"TODO","children":[],"payload":{"tag":"li","lines":"225,227"}}],"payload":{"tag":"h5","lines":"223,224"}},{"content":"<code>-PE</code> \"ICMP echo\"","children":[{"content":"\n<pre data-lines=\"230,233\"><code data-lines=\"230,233\"><span class=\"hljs-symbol\">sudo</span> nmap -<span class=\"hljs-meta\">sn</span> -PE --send-<span class=\"hljs-built_in\">ip</span>  <span class=\"hljs-number\">172</span>.<span class=\"hljs-number\">31</span>.<span class=\"hljs-number\">33</span>.<span class=\"hljs-number\">76</span>\n</code></pre>\n<p data-lines=\"233,235\"><img src=\"./docs/nmap_priv_sn_PE_send-ip_2.png?raw=true\" alt=\"nmap_priv_sn_PE_send-ip_2\"><br>\n\"ICMP echo discovery probes\"</p>","children":[],"payload":{"tag":"li","lines":"229,236"}},{"content":"\n<pre data-lines=\"237,240\"><code data-lines=\"237,240\"><span class=\"hljs-symbol\">sudo</span> nmap -<span class=\"hljs-meta\">sn</span> -PE --send-<span class=\"hljs-built_in\">ip</span> <span class=\"hljs-number\">192</span>.<span class=\"hljs-number\">168</span>.<span class=\"hljs-number\">79</span>.<span class=\"hljs-number\">201</span>\n</code></pre>\n<p data-lines=\"240,242\"><img src=\"./docs/nmap_priv_sn_PE_send-ip.png?raw=true\" alt=\"nmap_priv_sn_PE_send-ip\"><br>\n\"ICMP echo discovery probes\"</p>","children":[],"payload":{"tag":"li","lines":"236,243"}}],"payload":{"tag":"h5","lines":"227,228"}},{"content":"<code>-PP</code> \"ICMP Timestamp\"","children":[{"content":"TODO","children":[],"payload":{"tag":"li","lines":"245,247"}}],"payload":{"tag":"h5","lines":"243,244"}},{"content":"<code>-PM</code> \"ICMP address mask\"","children":[{"content":"TODO","children":[],"payload":{"tag":"li","lines":"249,251"}}],"payload":{"tag":"h5","lines":"247,248"}},{"content":"<code>-PS</code> \"TCP SYN Ping\"","children":[{"content":"\n<pre data-lines=\"254,257\"><code data-lines=\"254,257\"><span class=\"hljs-symbol\">sudo</span> nmap -<span class=\"hljs-meta\">sn</span> -PS --send-<span class=\"hljs-built_in\">ip</span>  <span class=\"hljs-number\">192</span>.<span class=\"hljs-number\">168</span>.<span class=\"hljs-number\">79</span>.<span class=\"hljs-number\">201</span>\n</code></pre>\n<img src=\"./docs/nmap_priv_sn_PS_send-ip.png?raw=true\" alt=\"nmap_priv_sn_PS_send-ip\"><br>\n\"sends an empty TCP packet with the SYN flag set. The default destination port is 80. Alternate ports can be specified as a parameter\"","children":[],"payload":{"tag":"li","lines":"253,260"}}],"payload":{"tag":"h5","lines":"251,252"}},{"content":"<code>-PA</code> \"TCP ACK Ping\"","children":[{"content":"\n<pre data-lines=\"263,266\"><code data-lines=\"263,266\"><span class=\"hljs-symbol\">sudo</span> nmap -<span class=\"hljs-meta\">sn</span> -PA --send-<span class=\"hljs-built_in\">ip</span> <span class=\"hljs-number\">192</span>.<span class=\"hljs-number\">168</span>.<span class=\"hljs-number\">79</span>.<span class=\"hljs-number\">201</span>\n</code></pre>\n<img src=\"./docs/nmap_priv_sn_PA_send-ip.png?raw=true\" alt=\"nmap_priv_sn_PA_send-ip\"><br>\n\"he TCP ACK flag is set instead of the SYN flag. uses the same default port as the SYN probe (80) and can also take a list of destination ports in the same format\"","children":[],"payload":{"tag":"li","lines":"262,269"}}],"payload":{"tag":"h5","lines":"260,261"}},{"content":"<code>-PU</code> \"UDP Ping\"","children":[{"content":"\n<pre data-lines=\"272,275\"><code data-lines=\"272,275\"><span class=\"hljs-attribute\">sudo</span> nmap -sn -PU137,<span class=\"hljs-number\">138</span> --send-ip <span class=\"hljs-number\">192.168.1.23</span>\n</code></pre>\n<img src=\"./docs/nmap_priv_sn_PU_send-ip.png?raw=true\" alt=\"nmap_priv_sn_PU_send-ip\"><br>\n\"Upon hitting a closed port on the target machine, the UDP probe should elicit an ICMP port unreachable packet in return. This signifies to Nmap that the machine is up and available\"","children":[],"payload":{"tag":"li","lines":"271,279"}}],"payload":{"tag":"h5","lines":"269,270"}}],"payload":{"tag":"h4","lines":"221,222"}},{"content":"IP range","children":[{"content":"TODO","children":[],"payload":{"tag":"li","lines":"281,283"}}],"payload":{"tag":"h4","lines":"279,280"}}],"payload":{"tag":"h3","lines":"219,220"}}],"payload":{"tag":"h2","lines":"147,148"}},{"content":"external network","children":[{"content":"use raw ethernet","children":[{"content":"single IP","children":[{"content":"TODO","children":[],"payload":{"tag":"li","lines":"289,291"}}],"payload":{"tag":"h4","lines":"287,288"}},{"content":"IP range","children":[{"content":"TODO","children":[],"payload":{"tag":"li","lines":"293,295"}}],"payload":{"tag":"h4","lines":"291,292"}}],"payload":{"tag":"h3","lines":"285,286"}},{"content":"use raw IP","children":[{"content":"single IP","children":[{"content":"TODO","children":[],"payload":{"tag":"li","lines":"299,301"}}],"payload":{"tag":"h4","lines":"297,298"}},{"content":"IP range","children":[{"content":"TODO","children":[],"payload":{"tag":"li","lines":"303,304"}}],"payload":{"tag":"h4","lines":"301,302"}}],"payload":{"tag":"h3","lines":"295,296"}}],"payload":{"tag":"h2","lines":"283,284"}}],"payload":{"tag":"h1","lines":"145,146"}}]},{"colorFreezeLevel":10})</script>
</body>
</html>
